<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1400 1000" font-family="Segoe UI, Arial, sans-serif">
  <defs>
    <linearGradient id="userGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#7b1fa2;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#4a148c;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="groupGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#1976d2;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#0d47a1;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="apiGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#2e7d32;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#1b5e20;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="tagGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f57c00;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#e65100;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="gwGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#c62828;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#b71c1c;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="openamGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#ff5722;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#e64a19;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="3" stdDeviation="3" flood-opacity="0.3"/>
    </filter>
    <marker id="arrowBlue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#1976d2"/>
    </marker>
    <marker id="arrowGreen" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2e7d32"/>
    </marker>
    <marker id="arrowOrange" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#f57c00"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="1400" height="1000" fill="#eceff1"/>
  
  <!-- Title -->
  <text x="700" y="35" text-anchor="middle" font-size="26" font-weight="bold" fill="#263238">API Group Separation &amp; RBAC Model</text>
  <text x="700" y="58" text-anchor="middle" font-size="14" fill="#546e7a">User Groups " API Membership " Role-Based Access " Sharding Tags</text>
  
  <!-- ==================== USERS SECTION ==================== -->
  <rect x="30" y="80" width="320" height="380" rx="10" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="2" filter="url(#shadow)"/>
  <text x="190" y="110" text-anchor="middle" font-size="16" font-weight="bold" fill="#4a148c">USERS (from OpenAM)</text>
  
  <!-- User 1 - Payment Team -->
  <rect x="50" y="130" width="280" height="70" rx="6" fill="url(#userGrad)"/>
  <text x="70" y="155" font-size="16" fill="#fff">=d</text>
  <text x="95" y="155" font-size="12" font-weight="bold" fill="#fff">Alice (alice@company.com)</text>
  <text x="70" y="175" font-size="10" fill="rgba(255,255,255,0.9)">OpenAM Groups: [payment-team, api-publishers]</text>
  <text x="70" y="190" font-size="9" fill="rgba(255,255,255,0.7)">Role: API_PUBLISHER</text>
  
  <!-- User 2 - Order Team -->
  <rect x="50" y="210" width="280" height="70" rx="6" fill="url(#userGrad)"/>
  <text x="70" y="235" font-size="16" fill="#fff">=d</text>
  <text x="95" y="235" font-size="12" font-weight="bold" fill="#fff">Bob (bob@company.com)</text>
  <text x="70" y="255" font-size="10" fill="rgba(255,255,255,0.9)">OpenAM Groups: [order-team, api-publishers]</text>
  <text x="70" y="270" font-size="9" fill="rgba(255,255,255,0.7)">Role: API_PUBLISHER</text>
  
  <!-- User 3 - User Team -->
  <rect x="50" y="290" width="280" height="70" rx="6" fill="url(#userGrad)"/>
  <text x="70" y="315" font-size="16" fill="#fff">=d</text>
  <text x="95" y="315" font-size="12" font-weight="bold" fill="#fff">Charlie (charlie@company.com)</text>
  <text x="70" y="335" font-size="10" fill="rgba(255,255,255,0.9)">OpenAM Groups: [user-team, api-publishers]</text>
  <text x="70" y="350" font-size="9" fill="rgba(255,255,255,0.7)">Role: API_PUBLISHER</text>
  
  <!-- User 4 - Platform Admin -->
  <rect x="50" y="370" width="280" height="70" rx="6" fill="#6a1b9a"/>
  <text x="70" y="395" font-size="16" fill="#fff">=Q</text>
  <text x="95" y="395" font-size="12" font-weight="bold" fill="#fff">Admin (admin@company.com)</text>
  <text x="70" y="415" font-size="10" fill="rgba(255,255,255,0.9)">OpenAM Groups: [platform-admins]</text>
  <text x="70" y="430" font-size="9" fill="rgba(255,255,255,0.7)">Role: ENVIRONMENT_ADMIN (Full Access)</text>
  
  <!-- ==================== GROUPS SECTION ==================== -->
  <rect x="380" y="80" width="320" height="380" rx="10" fill="#e3f2fd" stroke="#1976d2" stroke-width="2" filter="url(#shadow)"/>
  <text x="540" y="110" text-anchor="middle" font-size="16" font-weight="bold" fill="#0d47a1">GRAVITEE GROUPS</text>
  
  <!-- Group 1 - Payment Team -->
  <rect x="400" y="130" width="280" height="80" rx="6" fill="url(#groupGrad)"/>
  <text x="420" y="155" font-size="12" font-weight="bold" fill="#fff"><÷ Payment Team Group</text>
  <text x="420" y="175" font-size="10" fill="rgba(255,255,255,0.9)">Members: Alice</text>
  <text x="420" y="192" font-size="9" fill="rgba(255,255,255,0.7)">Permissions: API_PUBLISHER on Payment APIs</text>
  
  <!-- Group 2 - Order Team -->
  <rect x="400" y="220" width="280" height="80" rx="6" fill="url(#groupGrad)"/>
  <text x="420" y="245" font-size="12" font-weight="bold" fill="#fff"><÷ Order Team Group</text>
  <text x="420" y="265" font-size="10" fill="rgba(255,255,255,0.9)">Members: Bob</text>
  <text x="420" y="282" font-size="9" fill="rgba(255,255,255,0.7)">Permissions: API_PUBLISHER on Order APIs</text>
  
  <!-- Group 3 - User Team -->
  <rect x="400" y="310" width="280" height="80" rx="6" fill="url(#groupGrad)"/>
  <text x="420" y="335" font-size="12" font-weight="bold" fill="#fff"><÷ User Team Group</text>
  <text x="420" y="355" font-size="10" fill="rgba(255,255,255,0.9)">Members: Charlie</text>
  <text x="420" y="372" font-size="9" fill="rgba(255,255,255,0.7)">Permissions: API_PUBLISHER on User APIs</text>
  
  <!-- Group 4 - Platform Admin -->
  <rect x="400" y="400" width="280" height="50" rx="6" fill="#1565c0"/>
  <text x="420" y="425" font-size="12" font-weight="bold" fill="#fff">=Q Platform Admins Group</text>
  <text x="420" y="442" font-size="9" fill="rgba(255,255,255,0.7)">Full access to all APIs and settings</text>
  
  <!-- ==================== APIs SECTION ==================== -->
  <rect x="730" y="80" width="320" height="380" rx="10" fill="#e8f5e9" stroke="#2e7d32" stroke-width="2" filter="url(#shadow)"/>
  <text x="890" y="110" text-anchor="middle" font-size="16" font-weight="bold" fill="#1b5e20">APIs (Group Membership)</text>
  
  <!-- API 1 - Payment API -->
  <rect x="750" y="130" width="280" height="80" rx="6" fill="url(#apiGrad)"/>
  <text x="770" y="155" font-size="12" font-weight="bold" fill="#fff">=æ Payment API v1</text>
  <text x="770" y="175" font-size="10" fill="rgba(255,255,255,0.9)">Group: Payment Team</text>
  <text x="770" y="192" font-size="9" fill="rgba(255,255,255,0.7)"> Alice can edit | L Bob, Charlie cannot</text>
  
  <!-- API 2 - Order API -->
  <rect x="750" y="220" width="280" height="80" rx="6" fill="url(#apiGrad)"/>
  <text x="770" y="245" font-size="12" font-weight="bold" fill="#fff">=æ Order API v1</text>
  <text x="770" y="265" font-size="10" fill="rgba(255,255,255,0.9)">Group: Order Team</text>
  <text x="770" y="282" font-size="9" fill="rgba(255,255,255,0.7)"> Bob can edit | L Alice, Charlie cannot</text>
  
  <!-- API 3 - User API -->
  <rect x="750" y="310" width="280" height="80" rx="6" fill="url(#apiGrad)"/>
  <text x="770" y="335" font-size="12" font-weight="bold" fill="#fff">=æ User API v1</text>
  <text x="770" y="355" font-size="10" fill="rgba(255,255,255,0.9)">Group: User Team</text>
  <text x="770" y="372" font-size="9" fill="rgba(255,255,255,0.7)"> Charlie can edit | L Alice, Bob cannot</text>
  
  <!-- API 4 - Shared API -->
  <rect x="750" y="400" width="280" height="50" rx="6" fill="#43a047"/>
  <text x="770" y="425" font-size="12" font-weight="bold" fill="#fff">=æ Shared Internal API</text>
  <text x="770" y="442" font-size="9" fill="rgba(255,255,255,0.7)">Groups: All Teams (Read) | Admins (Write)</text>
  
  <!-- ==================== SHARDING TAGS SECTION ==================== -->
  <rect x="1080" y="80" width="290" height="380" rx="10" fill="#fff3e0" stroke="#f57c00" stroke-width="2" filter="url(#shadow)"/>
  <text x="1225" y="110" text-anchor="middle" font-size="16" font-weight="bold" fill="#e65100">SHARDING TAGS</text>
  <text x="1225" y="128" text-anchor="middle" font-size="10" fill="#bf360c">(Deploy to specific Gateways)</text>
  
  <!-- Tag 1 - internal-us -->
  <rect x="1100" y="145" width="250" height="55" rx="6" fill="url(#tagGrad)"/>
  <text x="1120" y="170" font-size="11" font-weight="bold" fill="#fff"><÷ internal-us</text>
  <text x="1120" y="188" font-size="9" fill="rgba(255,255,255,0.9)">US Internal Gateway Cluster</text>
  
  <!-- Tag 2 - internal-eu -->
  <rect x="1100" y="210" width="250" height="55" rx="6" fill="url(#tagGrad)"/>
  <text x="1120" y="235" font-size="11" font-weight="bold" fill="#fff"><÷ internal-eu</text>
  <text x="1120" y="253" font-size="9" fill="rgba(255,255,255,0.9)">EU Internal Gateway Cluster</text>
  
  <!-- Tag 3 - internal-asia -->
  <rect x="1100" y="275" width="250" height="55" rx="6" fill="url(#tagGrad)"/>
  <text x="1120" y="300" font-size="11" font-weight="bold" fill="#fff"><÷ internal-asia</text>
  <text x="1120" y="318" font-size="9" fill="rgba(255,255,255,0.9)">ASIA Internal Gateway Cluster</text>
  
  <!-- Tag 4 - payment-gw -->
  <rect x="1100" y="340" width="250" height="55" rx="6" fill="#ef6c00"/>
  <text x="1120" y="365" font-size="11" font-weight="bold" fill="#fff"><÷ payment-gw</text>
  <text x="1120" y="383" font-size="9" fill="rgba(255,255,255,0.9)">Payment Team allowed only</text>
  
  <!-- Tag 5 - all-internal -->
  <rect x="1100" y="405" width="250" height="45" rx="6" fill="#ff8f00"/>
  <text x="1120" y="430" font-size="11" font-weight="bold" fill="#fff"><÷ all-internal</text>
  <text x="1120" y="445" font-size="9" fill="rgba(255,255,255,0.9)">All Internal Gateways</text>
  
  <!-- ==================== CONNECTION ARROWS ==================== -->
  
  <!-- Users to Groups -->
  <line x1="330" y1="165" x2="400" y2="165" stroke="#1976d2" stroke-width="2" marker-end="url(#arrowBlue)"/>
  <line x1="330" y1="245" x2="400" y2="255" stroke="#1976d2" stroke-width="2" marker-end="url(#arrowBlue)"/>
  <line x1="330" y1="325" x2="400" y2="345" stroke="#1976d2" stroke-width="2" marker-end="url(#arrowBlue)"/>
  <line x1="330" y1="405" x2="400" y2="420" stroke="#1976d2" stroke-width="2" marker-end="url(#arrowBlue)"/>
  
  <!-- Groups to APIs -->
  <line x1="680" y1="165" x2="750" y2="165" stroke="#2e7d32" stroke-width="2" marker-end="url(#arrowGreen)"/>
  <line x1="680" y1="255" x2="750" y2="255" stroke="#2e7d32" stroke-width="2" marker-end="url(#arrowGreen)"/>
  <line x1="680" y1="345" x2="750" y2="345" stroke="#2e7d32" stroke-width="2" marker-end="url(#arrowGreen)"/>
  
  <!-- APIs to Tags -->
  <line x1="1030" y1="165" x2="1100" y2="170" stroke="#f57c00" stroke-width="2" marker-end="url(#arrowOrange)"/>
  <line x1="1030" y1="255" x2="1100" y2="235" stroke="#f57c00" stroke-width="2" marker-end="url(#arrowOrange)"/>
  <line x1="1030" y1="345" x2="1100" y2="300" stroke="#f57c00" stroke-width="2" marker-end="url(#arrowOrange)"/>
  
  <!-- ==================== GATEWAY DEPLOYMENT ==================== -->
  <rect x="30" y="490" width="1340" height="200" rx="10" fill="#ffebee" stroke="#c62828" stroke-width="2" filter="url(#shadow)"/>
  <text x="700" y="520" text-anchor="middle" font-size="16" font-weight="bold" fill="#b71c1c">API GATEWAY CLUSTERS (Sharding Tag Assignment)</text>
  
  <!-- US Gateway -->
  <rect x="60" y="545" width="300" height="120" rx="8" fill="url(#gwGrad)"/>
  <text x="210" y="575" text-anchor="middle" font-size="13" font-weight="bold" fill="#fff">¡ US Internal Gateway</text>
  <text x="210" y="600" text-anchor="middle" font-size="10" fill="rgba(255,255,255,0.9)">Tags: [internal-us, all-internal]</text>
  <rect x="80" y="615" width="120" height="35" rx="4" fill="rgba(255,255,255,0.2)"/>
  <text x="140" y="637" text-anchor="middle" font-size="9" fill="#fff">Order API </text>
  <rect x="210" y="615" width="120" height="35" rx="4" fill="rgba(255,255,255,0.2)"/>
  <text x="270" y="637" text-anchor="middle" font-size="9" fill="#fff">User API </text>
  
  <!-- EU Gateway -->
  <rect x="400" y="545" width="300" height="120" rx="8" fill="url(#gwGrad)"/>
  <text x="550" y="575" text-anchor="middle" font-size="13" font-weight="bold" fill="#fff">¡ EU Internal Gateway</text>
  <text x="550" y="600" text-anchor="middle" font-size="10" fill="rgba(255,255,255,0.9)">Tags: [internal-eu, all-internal]</text>
  <rect x="420" y="615" width="120" height="35" rx="4" fill="rgba(255,255,255,0.2)"/>
  <text x="480" y="637" text-anchor="middle" font-size="9" fill="#fff">Order API </text>
  <rect x="550" y="615" width="120" height="35" rx="4" fill="rgba(255,255,255,0.2)"/>
  <text x="610" y="637" text-anchor="middle" font-size="9" fill="#fff">User API </text>
  
  <!-- ASIA Gateway -->
  <rect x="740" y="545" width="300" height="120" rx="8" fill="url(#gwGrad)"/>
  <text x="890" y="575" text-anchor="middle" font-size="13" font-weight="bold" fill="#fff">¡ ASIA Internal Gateway</text>
  <text x="890" y="600" text-anchor="middle" font-size="10" fill="rgba(255,255,255,0.9)">Tags: [internal-asia, all-internal]</text>
  <rect x="760" y="615" width="120" height="35" rx="4" fill="rgba(255,255,255,0.2)"/>
  <text x="820" y="637" text-anchor="middle" font-size="9" fill="#fff">Order API </text>
  <rect x="890" y="615" width="120" height="35" rx="4" fill="rgba(255,255,255,0.2)"/>
  <text x="950" y="637" text-anchor="middle" font-size="9" fill="#fff">User API </text>
  
  <!-- Payment Gateway (Special) -->
  <rect x="1080" y="545" width="270" height="120" rx="8" fill="#d84315"/>
  <text x="1215" y="575" text-anchor="middle" font-size="13" font-weight="bold" fill="#fff">=³ Payment Gateway</text>
  <text x="1215" y="600" text-anchor="middle" font-size="10" fill="rgba(255,255,255,0.9)">Tags: [payment-gw]</text>
  <text x="1215" y="620" text-anchor="middle" font-size="9" fill="rgba(255,255,255,0.7)">Only Payment Team can deploy</text>
  <rect x="1130" y="635" width="170" height="25" rx="4" fill="rgba(255,255,255,0.2)"/>
  <text x="1215" y="652" text-anchor="middle" font-size="9" fill="#fff">Payment API </text>
  
  <!-- ==================== ACCESS CONTROL MATRIX ==================== -->
  <rect x="30" y="710" width="1340" height="270" rx="10" fill="#fff" stroke="#546e7a" stroke-width="2" filter="url(#shadow)"/>
  <text x="700" y="740" text-anchor="middle" font-size="18" font-weight="bold" fill="#263238">Access Control Matrix</text>
  
  <!-- Table Header -->
  <rect x="50" y="760" width="180" height="35" fill="#37474f"/>
  <text x="140" y="783" text-anchor="middle" font-size="11" font-weight="bold" fill="#fff">User</text>
  <rect x="230" y="760" width="200" height="35" fill="#37474f"/>
  <text x="330" y="783" text-anchor="middle" font-size="11" font-weight="bold" fill="#fff">Can Edit APIs</text>
  <rect x="430" y="760" width="250" height="35" fill="#37474f"/>
  <text x="555" y="783" text-anchor="middle" font-size="11" font-weight="bold" fill="#fff">Allowed Sharding Tags</text>
  <rect x="680" y="760" width="300" height="35" fill="#37474f"/>
  <text x="830" y="783" text-anchor="middle" font-size="11" font-weight="bold" fill="#fff">Cannot Access</text>
  <rect x="980" y="760" width="370" height="35" fill="#37474f"/>
  <text x="1165" y="783" text-anchor="middle" font-size="11" font-weight="bold" fill="#fff">Publish Restriction</text>
  
  <!-- Row 1 - Alice -->
  <rect x="50" y="795" width="180" height="40" fill="#f3e5f5"/>
  <text x="140" y="820" text-anchor="middle" font-size="10" fill="#4a148c">=d Alice (Payment Team)</text>
  <rect x="230" y="795" width="200" height="40" fill="#e8f5e9"/>
  <text x="330" y="820" text-anchor="middle" font-size="10" fill="#2e7d32">Payment API </text>
  <rect x="430" y="795" width="250" height="40" fill="#fff3e0"/>
  <text x="555" y="820" text-anchor="middle" font-size="10" fill="#e65100">payment-gw, internal-eu</text>
  <rect x="680" y="795" width="300" height="40" fill="#ffebee"/>
  <text x="830" y="820" text-anchor="middle" font-size="10" fill="#c62828">Order API L, User API L</text>
  <rect x="980" y="795" width="370" height="40" fill="#fce4ec"/>
  <text x="1165" y="820" text-anchor="middle" font-size="10" fill="#880e4f">Cannot deploy to internal-us, internal-asia</text>
  
  <!-- Row 2 - Bob -->
  <rect x="50" y="835" width="180" height="40" fill="#f3e5f5"/>
  <text x="140" y="860" text-anchor="middle" font-size="10" fill="#4a148c">=d Bob (Order Team)</text>
  <rect x="230" y="835" width="200" height="40" fill="#e8f5e9"/>
  <text x="330" y="860" text-anchor="middle" font-size="10" fill="#2e7d32">Order API </text>
  <rect x="430" y="835" width="250" height="40" fill="#fff3e0"/>
  <text x="555" y="860" text-anchor="middle" font-size="10" fill="#e65100">internal-us, internal-eu, internal-asia</text>
  <rect x="680" y="835" width="300" height="40" fill="#ffebee"/>
  <text x="830" y="860" text-anchor="middle" font-size="10" fill="#c62828">Payment API L, User API L</text>
  <rect x="980" y="835" width="370" height="40" fill="#fce4ec"/>
  <text x="1165" y="860" text-anchor="middle" font-size="10" fill="#880e4f">Cannot deploy to payment-gw</text>
  
  <!-- Row 3 - Charlie -->
  <rect x="50" y="875" width="180" height="40" fill="#f3e5f5"/>
  <text x="140" y="900" text-anchor="middle" font-size="10" fill="#4a148c">=d Charlie (User Team)</text>
  <rect x="230" y="875" width="200" height="40" fill="#e8f5e9"/>
  <text x="330" y="900" text-anchor="middle" font-size="10" fill="#2e7d32">User API </text>
  <rect x="430" y="875" width="250" height="40" fill="#fff3e0"/>
  <text x="555" y="900" text-anchor="middle" font-size="10" fill="#e65100">internal-us, internal-eu</text>
  <rect x="680" y="875" width="300" height="40" fill="#ffebee"/>
  <text x="830" y="900" text-anchor="middle" font-size="10" fill="#c62828">Payment API L, Order API L</text>
  <rect x="980" y="875" width="370" height="40" fill="#fce4ec"/>
  <text x="1165" y="900" text-anchor="middle" font-size="10" fill="#880e4f">Cannot deploy to payment-gw, internal-asia</text>
  
  <!-- Row 4 - Admin -->
  <rect x="50" y="915" width="180" height="40" fill="#e8eaf6"/>
  <text x="140" y="940" text-anchor="middle" font-size="10" fill="#1a237e">=Q Admin (Platform Admin)</text>
  <rect x="230" y="915" width="200" height="40" fill="#c8e6c9"/>
  <text x="330" y="940" text-anchor="middle" font-size="10" fill="#1b5e20">ALL APIs </text>
  <rect x="430" y="915" width="250" height="40" fill="#ffe0b2"/>
  <text x="555" y="940" text-anchor="middle" font-size="10" fill="#bf360c">ALL TAGS </text>
  <rect x="680" y="915" width="300" height="40" fill="#c8e6c9"/>
  <text x="830" y="940" text-anchor="middle" font-size="10" fill="#1b5e20">None - Full Access</text>
  <rect x="980" y="915" width="370" height="40" fill="#c8e6c9"/>
  <text x="1165" y="940" text-anchor="middle" font-size="10" fill="#1b5e20">Can deploy anywhere</text>
</svg>
