<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1400 1010">
  <defs>
    <!-- Gradients -->
    <linearGradient id="globalLbGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#1a237e;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#3949ab;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="regionalLbGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#00695c;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#26a69a;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="k8sGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0277bd;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#29b6f6;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="controlPlaneGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#6a1b9a;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ab47bc;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="redisGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#c62828;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ef5350;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="esGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f57f17;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ffca28;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="dbGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#4527a0;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#7e57c2;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="openamGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#e65100;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ff9800;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="nodeGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#1565c0;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#42a5f5;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="coreZoneGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="userGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#546e7a;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#78909c;stop-opacity:1" />
    </linearGradient>
    
    <!-- Drop Shadow -->
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.3"/>
    </filter>
    
    <!-- Arrow Markers -->
    <marker id="arrowBlue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#1976d2"/>
    </marker>
    <marker id="arrowGreen" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#2e7d32"/>
    </marker>
    <marker id="arrowOrange" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#ef6c00"/>
    </marker>
    <marker id="arrowPurple" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#7b1fa2"/>
    </marker>
    <marker id="arrowRed" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#c62828"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="1400" height="1000" fill="#fafafa"/>
  
  <!-- Title -->
  <text x="700" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="22" font-weight="bold" fill="#1a237e">
    Internal API Gateway - High-Level Design (HLD) Architecture
  </text>
  <text x="700" y="50" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#616161">
    All Components in Core Zone | No DMZ Required | MongoDB External to K8s | Redis/ES in Cluster
  </text>
  
  <!-- ==================== CORE ZONE CONTAINER ==================== -->
  <rect x="15" y="60" width="1370" height="880" rx="15" fill="url(#coreZoneGrad)" stroke="#2e7d32" stroke-width="3"/>
  <rect x="15" y="60" width="50" height="880" rx="15 0 0 15" fill="#2e7d32"/>
  <text transform="translate(30, 550) rotate(-90)" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="white">CORE ZONE</text>
  
  <text x="700" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1b5e20">
    CORE ZONE - Single Zone Deployment (All Components Internal)
  </text>
  
  <!-- ==================== CORPORATE USERS SECTION ==================== -->
  <rect x="80" y="100" width="900" height="85" rx="8" fill="white" stroke="#546e7a" stroke-width="1" filter="url(#shadow)"/>
  <text x="530" y="120" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#37474f">
    CORPORATE USERS (Core Zone)
  </text>
  
  <!-- API Developers -->
  <rect x="100" y="130" width="130" height="45" rx="5" fill="url(#userGrad)" filter="url(#shadow)"/>
  <text x="165" y="150" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white">API Developers</text>
  <text x="165" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#cfd8dc">Console Access :443</text>
  
  <!-- Platform Team -->
  <rect x="250" y="130" width="130" height="45" rx="5" fill="url(#userGrad)" filter="url(#shadow)"/>
  <text x="315" y="150" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white">Platform Team</text>
  <text x="315" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#cfd8dc">Admin Access :443</text>
  
  <!-- App Developers -->
  <rect x="400" y="130" width="130" height="45" rx="5" fill="url(#userGrad)" filter="url(#shadow)"/>
  <text x="465" y="150" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white">App Developers</text>
  <text x="465" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#cfd8dc">Portal Access :443</text>
  
  <!-- API Consumer Apps -->
  <rect x="550" y="130" width="160" height="45" rx="5" fill="#455a64" filter="url(#shadow)"/>
  <text x="630" y="150" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white">API Consumer Apps</text>
  <text x="630" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#b0bec5">Microservices :8082</text>
  
  <!-- Internal Systems -->
  <rect x="730" y="130" width="160" height="45" rx="5" fill="#455a64" filter="url(#shadow)"/>
  <text x="810" y="150" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white">Internal Systems</text>
  <text x="810" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#b0bec5">Service Accounts</text>
  
  <!-- ==================== OPENAM SSO (CORE ZONE) ==================== -->
  <rect x="1000" y="100" width="360" height="85" rx="8" fill="white" stroke="#e65100" stroke-width="2" filter="url(#shadow)"/>
  <rect x="1000" y="100" width="360" height="25" rx="8 8 0 0" fill="url(#openamGrad)"/>
  <text x="1180" y="118" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">OpenAM SSO (Core Zone)</text>
  <text x="1180" y="142" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#424242">OAuth 2.0 / OIDC Provider</text>
  <text x="1180" y="158" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#757575">/oauth2/authorize | /oauth2/token | /oauth2/introspect | /oauth2/jwks</text>
  <text x="1180" y="174" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#9e9e9e">Connected to Corporate LDAP/AD | HTTPS :443</text>
  
  <!-- ==================== DATA PLANE SECTION ==================== -->
  <rect x="80" y="200" width="580" height="320" rx="10" fill="#e3f2fd" stroke="#1976d2" stroke-width="2" filter="url(#shadow)"/>
  <text x="370" y="225" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1565c0">
    DATA PLANE - Internal API Gateway (Core Zone)
  </text>
  
  <!-- Global Load Balancer -->
  <rect x="100" y="240" width="160" height="45" rx="8" fill="url(#globalLbGrad)" filter="url(#shadow)"/>
  <text x="180" y="260" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white">Global Load Balancer</text>
  <text x="180" y="275" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#bbdefb">(Internal GSLB)</text>
  
  <!-- ===== US REGION ===== -->
  <rect x="100" y="295" width="170" height="110" rx="8" fill="#e8f5e9" stroke="#2e7d32" stroke-width="2"/>
  <text x="185" y="313" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#1b5e20">US REGION</text>
  
  <rect x="110" y="325" width="70" height="22" rx="4" fill="url(#regionalLbGrad)"/>
  <text x="145" y="340" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" font-weight="bold" fill="white">Regional LB</text>
  
  <rect x="110" y="355" width="70" height="42" rx="4" fill="url(#nodeGrad)"/>
  <text x="145" y="373" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" font-weight="bold" fill="white">GW Node 1</text>
  <text x="145" y="387" text-anchor="middle" font-family="Arial, sans-serif" font-size="6" fill="#90caf9">:8082 (2 pods)</text>
  
  <rect x="190" y="355" width="70" height="42" rx="4" fill="url(#nodeGrad)"/>
  <text x="225" y="373" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" font-weight="bold" fill="white">GW Node 2</text>
  <text x="225" y="387" text-anchor="middle" font-family="Arial, sans-serif" font-size="6" fill="#90caf9">:8082 (2 pods)</text>
  
  <!-- ===== EU REGION ===== -->
  <rect x="290" y="295" width="170" height="110" rx="8" fill="#fff3e0" stroke="#ef6c00" stroke-width="2"/>
  <text x="375" y="313" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#e65100">EU REGION</text>
  
  <rect x="300" y="325" width="70" height="22" rx="4" fill="url(#regionalLbGrad)"/>
  <text x="335" y="340" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" font-weight="bold" fill="white">Regional LB</text>
  
  <rect x="300" y="355" width="70" height="42" rx="4" fill="url(#nodeGrad)"/>
  <text x="335" y="373" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" font-weight="bold" fill="white">GW Node 1</text>
  <text x="335" y="387" text-anchor="middle" font-family="Arial, sans-serif" font-size="6" fill="#90caf9">:8082 (2 pods)</text>
  
  <rect x="380" y="355" width="70" height="42" rx="4" fill="url(#nodeGrad)"/>
  <text x="415" y="373" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" font-weight="bold" fill="white">GW Node 2</text>
  <text x="415" y="387" text-anchor="middle" font-family="Arial, sans-serif" font-size="6" fill="#90caf9">:8082 (2 pods)</text>
  
  <!-- ===== ASIA REGION ===== -->
  <rect x="480" y="295" width="170" height="110" rx="8" fill="#fce4ec" stroke="#c2185b" stroke-width="2"/>
  <text x="565" y="313" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#880e4f">ASIA REGION</text>
  
  <rect x="490" y="325" width="70" height="22" rx="4" fill="url(#regionalLbGrad)"/>
  <text x="525" y="340" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" font-weight="bold" fill="white">Regional LB</text>
  
  <rect x="490" y="355" width="70" height="42" rx="4" fill="url(#nodeGrad)"/>
  <text x="525" y="373" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" font-weight="bold" fill="white">GW Node 1</text>
  <text x="525" y="387" text-anchor="middle" font-family="Arial, sans-serif" font-size="6" fill="#90caf9">:8082 (2 pods)</text>
  
  <rect x="570" y="355" width="70" height="42" rx="4" fill="url(#nodeGrad)"/>
  <text x="605" y="373" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" font-weight="bold" fill="white">GW Node 2</text>
  <text x="605" y="387" text-anchor="middle" font-family="Arial, sans-serif" font-size="6" fill="#90caf9">:8082 (2 pods)</text>
  
  <!-- Security & Policy Layers -->
  <rect x="100" y="415" width="550" height="20" rx="5" fill="#00695c"/>
  <text x="375" y="429" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="white">
    TLS 1.2/1.3 | mTLS | JWT Validation | Rate Limiting | IP Filtering
  </text>
  
  <rect x="100" y="440" width="550" height="20" rx="5" fill="#37474f"/>
  <text x="375" y="454" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="white">
    Policies: Transform | Cache | Quota | Circuit Breaker | Mock | Logging
  </text>
  
  <rect x="100" y="465" width="550" height="20" rx="5" fill="#546e7a"/>
  <text x="375" y="479" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="white">
    Analytics Collection | Request/Response Logging | Metrics Export
  </text>
  
  <!-- ==================== CONTROL PLANE SECTION ==================== -->
  <rect x="680" y="200" width="680" height="320" rx="10" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="2" filter="url(#shadow)"/>
  <text x="1020" y="225" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#6a1b9a">
    CONTROL PLANE - Kubernetes Cluster (Core Zone)
  </text>
  
  <!-- Management Components Row -->
  <rect x="700" y="245" width="200" height="60" rx="5" fill="#9c27b0" stroke="#4a148c" stroke-width="1" filter="url(#shadow)"/>
  <text x="800" y="268" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white">Console UI</text>
  <text x="800" y="283" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#e1bee7">Management Interface</text>
  <text x="800" y="297" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#ce93d8">HTTPS :443 | 2 Replicas</text>
  
  <rect x="920" y="245" width="200" height="60" rx="5" fill="#9c27b0" stroke="#4a148c" stroke-width="1" filter="url(#shadow)"/>
  <text x="1020" y="268" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white">Management API</text>
  <text x="1020" y="283" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#e1bee7">REST API Backend</text>
  <text x="1020" y="297" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#ce93d8">HTTPS :8083 | 2 Replicas</text>
  
  <rect x="1140" y="245" width="200" height="60" rx="5" fill="#9c27b0" stroke="#4a148c" stroke-width="1" filter="url(#shadow)"/>
  <text x="1240" y="268" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white">Developer Portal</text>
  <text x="1240" y="283" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#e1bee7">API Catalog</text>
  <text x="1240" y="297" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#ce93d8">HTTPS :443 | 2 Replicas</text>
  
  <!-- Data Services Row (Redis + Elasticsearch INSIDE Control Plane) -->
  <rect x="700" y="320" width="640" height="80" rx="5" fill="#eceff1" stroke="#607d8b" stroke-width="1"/>
  <text x="1020" y="338" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#37474f">Data Services (In-Cluster)</text>
  
  <!-- Redis -->
  <rect x="720" y="350" width="280" height="40" rx="5" fill="url(#redisGrad)" filter="url(#shadow)"/>
  <text x="860" y="368" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="white">Redis Cluster</text>
  <text x="860" y="382" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#ffcdd2">Rate Limiting | Caching | Session | TLS :6379 | 6 nodes</text>
  
  <!-- Elasticsearch -->
  <rect x="1020" y="350" width="300" height="40" rx="5" fill="url(#esGrad)" filter="url(#shadow)"/>
  <text x="1170" y="368" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#3e2723">Elasticsearch Cluster</text>
  <text x="1170" y="382" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#5d4037">Analytics | Logs | Metrics | HTTPS :9200 | 3 nodes</text>
  
  <!-- Infrastructure Services Row -->
  <rect x="700" y="410" width="640" height="45" rx="5" fill="white" stroke="#9e9e9e" stroke-width="1"/>
  <text x="1020" y="428" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#37474f">Infrastructure Services</text>
  
  <rect x="710" y="435" width="60" height="14" rx="3" fill="#eceff1" stroke="#9e9e9e"/>
  <text x="740" y="445" text-anchor="middle" font-family="Arial, sans-serif" font-size="6" fill="#616161">NTP :123</text>
  
  <rect x="780" y="435" width="60" height="14" rx="3" fill="#eceff1" stroke="#9e9e9e"/>
  <text x="810" y="445" text-anchor="middle" font-family="Arial, sans-serif" font-size="6" fill="#616161">DNS :53</text>
  
  <rect x="850" y="435" width="80" height="14" rx="3" fill="#eceff1" stroke="#9e9e9e"/>
  <text x="890" y="445" text-anchor="middle" font-family="Arial, sans-serif" font-size="6" fill="#616161">LDAP :389,636</text>
  
  <rect x="940" y="435" width="60" height="14" rx="3" fill="#eceff1" stroke="#9e9e9e"/>
  <text x="970" y="445" text-anchor="middle" font-family="Arial, sans-serif" font-size="6" fill="#616161">SMTP :25</text>
  
  <rect x="1010" y="435" width="60" height="14" rx="3" fill="#eceff1" stroke="#9e9e9e"/>
  <text x="1040" y="445" text-anchor="middle" font-family="Arial, sans-serif" font-size="6" fill="#616161">PKI/CA</text>
  
  <rect x="1080" y="435" width="80" height="14" rx="3" fill="#e3f2fd" stroke="#326ce5"/>
  <text x="1120" y="445" text-anchor="middle" font-family="Arial, sans-serif" font-size="6" fill="#326ce5">K8s API :6443</text>
  
  <!-- RBAC Banner -->
  <rect x="700" y="465" width="640" height="22" rx="5" fill="#311b92"/>
  <text x="1020" y="480" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="white">
    RBAC: Group-based Permissions | Sharding Tags | Environment Separation | API Ownership
  </text>
  
  <!-- ==================== MONGODB SECTION (EXTERNAL TO CLUSTER) ==================== -->
  <rect x="80" y="535" width="580" height="90" rx="10" fill="white" stroke="#4527a0" stroke-width="2" filter="url(#shadow)"/>
  <rect x="80" y="535" width="580" height="25" rx="10 10 0 0" fill="url(#dbGrad)"/>
  <text x="370" y="552" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">
    MongoDB Cluster (Core Zone - External to K8s Cluster)
  </text>
  
  <rect x="100" y="570" width="160" height="45" rx="5" fill="#ede7f6" stroke="#7e57c2" stroke-width="1"/>
  <text x="180" y="590" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#4527a0">Primary Node</text>
  <text x="180" y="605" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#757575">Read/Write | :27017</text>
  
  <rect x="280" y="570" width="160" height="45" rx="5" fill="#ede7f6" stroke="#7e57c2" stroke-width="1"/>
  <text x="360" y="590" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#4527a0">Secondary Node 1</text>
  <text x="360" y="605" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#757575">Read Replica | :27017</text>
  
  <rect x="460" y="570" width="160" height="45" rx="5" fill="#ede7f6" stroke="#7e57c2" stroke-width="1"/>
  <text x="540" y="590" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#4527a0">Secondary Node 2</text>
  <text x="540" y="605" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#757575">Read Replica | :27017</text>
  
  <!-- MongoDB Data Description -->
  <text x="370" y="620" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#616161">
    API Definitions | Plans | Subscriptions | Users | Audit Logs | TLS Encrypted | Replica Set
  </text>
  
  <!-- ==================== BACKEND SERVICES ==================== -->
  <rect x="680" y="535" width="680" height="90" rx="10" fill="white" stroke="#263238" stroke-width="2" filter="url(#shadow)"/>
  <text x="1020" y="555" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#263238">
    BACKEND SERVICES (Core Zone)
  </text>
  
  <rect x="700" y="570" width="150" height="45" rx="5" fill="#eceff1" stroke="#607d8b"/>
  <text x="775" y="590" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#424242">Microservices</text>
  <text x="775" y="605" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" fill="#757575">REST/gRPC</text>
  
  <rect x="860" y="570" width="150" height="45" rx="5" fill="#eceff1" stroke="#607d8b"/>
  <text x="935" y="590" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#424242">Legacy Systems</text>
  <text x="935" y="605" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" fill="#757575">SOAP/EAI</text>
  
  <rect x="1020" y="570" width="150" height="45" rx="5" fill="#eceff1" stroke="#607d8b"/>
  <text x="1095" y="590" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#424242">Databases</text>
  <text x="1095" y="605" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" fill="#757575">SQL/NoSQL</text>
  
  <rect x="1180" y="570" width="160" height="45" rx="5" fill="#eceff1" stroke="#607d8b"/>
  <text x="1260" y="590" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="#424242">Message Queues</text>
  <text x="1260" y="605" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" fill="#757575">Kafka/RabbitMQ</text>
  
  <!-- ==================== FLOW ARROWS ==================== -->
  
  <!-- Users to OpenAM Authentication -->
  <path d="M 315 175 L 315 187 L 1000 187 L 1000 145" stroke="#e65100" stroke-width="2" fill="none" marker-end="url(#arrowOrange)"/>
  <circle cx="650" cy="187" r="10" fill="#e65100"/>
  <text x="650" y="191" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="white">1</text>
  
  <!-- API Consumers to Gateway -->
  <path d="M 630 175 L 630 192 L 180 192 L 180 240" stroke="#1976d2" stroke-width="2" fill="none" marker-end="url(#arrowBlue)"/>
  <circle cx="400" cy="192" r="10" fill="#1976d2"/>
  <text x="400" y="196" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="white">2</text>
  
  <!-- GSLB to Regional LBs -->
  <path d="M 180 285 L 180 290 L 145 290 L 145 325" stroke="#2e7d32" stroke-width="2" fill="none" marker-end="url(#arrowGreen)"/>
  <path d="M 180 290 L 335 290 L 335 325" stroke="#2e7d32" stroke-width="2" fill="none" marker-end="url(#arrowGreen)"/>
  <path d="M 180 290 L 525 290 L 525 325" stroke="#2e7d32" stroke-width="2" fill="none" marker-end="url(#arrowGreen)"/>
  <circle cx="260" cy="290" r="10" fill="#2e7d32"/>
  <text x="260" y="294" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="white">3</text>
  
  <!-- Gateway to OpenAM (Token Validation) -->
  <path d="M 650 370 L 672 370 L 672 145 L 1000 145" stroke="#c62828" stroke-width="2" fill="none" marker-end="url(#arrowRed)" stroke-dasharray="4,2,8,2"/>
  <circle cx="672" cy="255" r="10" fill="#c62828"/>
  <text x="672" y="259" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="white">4</text>
  <text x="687" y="310" font-family="Arial, sans-serif" font-size="7" fill="#c62828" transform="rotate(-90, 687, 310)">JWT Validation</text>
  
  <!-- Control Plane to MongoDB (External) -->
  <path d="M 1020 305 L 1020 320 L 680 505 L 370 505 L 370 535" stroke="#4527a0" stroke-width="2" fill="none" marker-end="url(#arrowPurple)" stroke-dasharray="8,4"/>
  <circle cx="680" cy="505" r="10" fill="#4527a0"/>
  <text x="680" y="509" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="white">5</text>
  <text x="530" y="497" font-family="Arial, sans-serif" font-size="7" fill="#4527a0">Config Read/Write</text>
  
  <!-- Gateway to MongoDB (Config Sync) -->
  <path d="M 370 490 L 370 535" stroke="#7b1fa2" stroke-width="2" fill="none" marker-end="url(#arrowPurple)" stroke-dasharray="8,4"/>
  <circle cx="370" cy="512" r="10" fill="#7b1fa2"/>
  <text x="370" y="516" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="white">6</text>
  <text x="400" y="510" font-family="Arial, sans-serif" font-size="7" fill="#7b1fa2">Config Pull</text>
  
  <!-- Gateway to Redis (In-Cluster) -->
  <path d="M 550 415 L 550 410 L 680 410 L 680 370 L 720 370" stroke="#c62828" stroke-width="2" fill="none" marker-end="url(#arrowRed)" stroke-dasharray="5,3"/>
  <text x="615" y="405" font-family="Arial, sans-serif" font-size="7" fill="#c62828">Rate Limit</text>
  
  <!-- Gateway to Elasticsearch (In-Cluster) -->
  <path d="M 600 440 L 660 440 L 660 370 L 1020 370" stroke="#f57f17" stroke-width="2" fill="none" marker-end="url(#arrowOrange)" stroke-dasharray="5,3"/>
  <text x="830" y="362" font-family="Arial, sans-serif" font-size="7" fill="#f57f17">Analytics</text>
  
  <!-- Gateway to Backends -->
  <path d="M 550 490 L 550 595 L 700 595" stroke="#455a64" stroke-width="2" fill="none" marker-end="url(#arrowBlue)"/>
  <circle cx="550" cy="550" r="10" fill="#455a64"/>
  <text x="550" y="554" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="white">7</text>
  
  <!-- Control Plane Auth to OpenAM -->
  <path d="M 800 245 L 800 220 L 1100 220 L 1100 185" stroke="#e65100" stroke-width="2" fill="none" stroke-dasharray="5,3"/>
  <text x="950" y="212" font-family="Arial, sans-serif" font-size="7" fill="#e65100">OAuth Login</text>
  
  <!-- ==================== LEGEND ==================== -->
  <rect x="80" y="640" width="1280" height="180" rx="10" fill="white" stroke="#9e9e9e" stroke-width="1"/>
  <text x="720" y="665" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#424242">LEGEND</text>
  
  <!-- Component Legend -->
  <rect x="100" y="685" width="50" height="16" rx="3" fill="url(#openamGrad)"/>
  <text x="160" y="697" font-family="Arial, sans-serif" font-size="9" fill="#424242">OpenAM SSO</text>
  
  <rect x="240" y="685" width="50" height="16" rx="3" fill="url(#k8sGrad)"/>
  <text x="300" y="697" font-family="Arial, sans-serif" font-size="9" fill="#424242">API Gateway</text>
  
  <rect x="380" y="685" width="50" height="16" rx="3" fill="url(#dbGrad)"/>
  <text x="440" y="697" font-family="Arial, sans-serif" font-size="9" fill="#424242">MongoDB (External)</text>
  
  <rect x="560" y="685" width="50" height="16" rx="3" fill="url(#redisGrad)"/>
  <text x="620" y="697" font-family="Arial, sans-serif" font-size="9" fill="#424242">Redis (In-Cluster)</text>
  
  <rect x="730" y="685" width="50" height="16" rx="3" fill="url(#esGrad)"/>
  <text x="790" y="697" font-family="Arial, sans-serif" font-size="9" fill="#424242">ES (In-Cluster)</text>
  
  <rect x="880" y="685" width="50" height="16" rx="3" fill="#9c27b0"/>
  <text x="940" y="697" font-family="Arial, sans-serif" font-size="9" fill="#424242">Control Plane</text>
  
  <!-- Flow Legend -->
  <line x1="1020" y1="693" x2="1070" y2="693" stroke="#424242" stroke-width="2"/>
  <text x="1080" y="697" font-family="Arial, sans-serif" font-size="9" fill="#424242">Data Flow</text>
  
  <line x1="1150" y1="693" x2="1200" y2="693" stroke="#7b1fa2" stroke-width="2" stroke-dasharray="8,4"/>
  <text x="1210" y="697" font-family="Arial, sans-serif" font-size="9" fill="#424242">Config/Admin</text>
  
  <line x1="1280" y1="693" x2="1330" y2="693" stroke="#c62828" stroke-width="2" stroke-dasharray="4,2,8,2"/>
  <text x="1340" y="697" font-family="Arial, sans-serif" font-size="9" fill="#424242">Security</text>
  
  <!-- Numbered Flow Explanations -->
  <text x="720" y="720" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#37474f">NUMBERED FLOW DESCRIPTIONS</text>
  
  <!-- Row 1 -->
  <circle cx="110" cy="745" r="10" fill="#e65100"/>
  <text x="110" y="749" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="white">1</text>
  <text x="130" y="749" font-family="Arial, sans-serif" font-size="9" fill="#424242">User Authentication: Corporate Users authenticate with OpenAM SSO (OAuth 2.0/OIDC)</text>
  
  <circle cx="710" cy="745" r="10" fill="#1976d2"/>
  <text x="710" y="749" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="white">2</text>
  <text x="730" y="749" font-family="Arial, sans-serif" font-size="9" fill="#424242">API Request: Consumer Apps send API requests to Global Load Balancer</text>
  
  <!-- Row 2 -->
  <circle cx="110" cy="768" r="10" fill="#2e7d32"/>
  <text x="110" y="772" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="white">3</text>
  <text x="130" y="772" font-family="Arial, sans-serif" font-size="9" fill="#424242">Load Distribution: GSLB routes traffic to Regional LBs (US/EU/ASIA)</text>
  
  <circle cx="710" cy="768" r="10" fill="#c62828"/>
  <text x="710" y="772" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="white">4</text>
  <text x="730" y="772" font-family="Arial, sans-serif" font-size="9" fill="#424242">Token Validation: Gateway validates JWT tokens with OpenAM (introspect/JWKS)</text>
  
  <!-- Row 3 -->
  <circle cx="110" cy="791" r="10" fill="#4527a0"/>
  <text x="110" y="795" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="white">5</text>
  <text x="130" y="795" font-family="Arial, sans-serif" font-size="9" fill="#424242">Config Management: Control Plane reads/writes API configs to MongoDB (external)</text>
  
  <circle cx="710" cy="791" r="10" fill="#7b1fa2"/>
  <text x="710" y="795" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="white">6</text>
  <text x="730" y="795" font-family="Arial, sans-serif" font-size="9" fill="#424242">Config Sync: Gateway pulls API definitions from MongoDB (pull-based sync)</text>
  
  <!-- Row 4 -->
  <circle cx="110" cy="814" r="10" fill="#455a64"/>
  <text x="110" y="818" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="white">7</text>
  <text x="130" y="818" font-family="Arial, sans-serif" font-size="9" fill="#424242">Backend Routing: Gateway proxies validated requests to Backend Services (mTLS/TLS)</text>
  
  <!-- Version -->
  <text x="1340" y="985" text-anchor="end" font-family="Arial, sans-serif" font-size="8" fill="#9e9e9e">v3.3 | Internal Gateway HLD - Core Zone Only | MongoDB External</text>
</svg>
